# MongoDB & Kubernetes.

Кластер кубера создал в gcp вручную.
![alt text](https://github.com/kot-mechanic/mongodb_otus/blob/main/screen/2022-02-08%2021_46_18-Window.png)

На локальной linux-машине установил и инициализировал google-cloud-sdk
```{r eval=FALSE}
# yum install google-cloud-sdk
# gcloud init
```
Ассоциировал GCP-шный кубер с локальным kubectl на своей машине
```{r eval=FALSE}
# gcloud container clusters get-credentials cluster-1 --zone us-central1-a
```

Скачал helm и положил в /usr/local/bin/, затем подключил репозиторий bitnami.
```{r eval=FALSE}
# cp /opt/distr/linux-amd64/helm /usr/local/bin/
# helm repo add bitnami https://charts.bitnami.com/bitnami
```
Создал конфиг my_values.yaml и установил из репозитория bitnami кластер монго.
![alt text](https://github.com/kot-mechanic/mongodb_otus/blob/main/screen/2022-02-08%2021_07_15-Window.png)

Посмотрел, что получилось.

![alt text](https://github.com/kot-mechanic/mongodb_otus/blob/main/screen/2022-02-08%2021_07_33-Window.png)

Пробросил порт с GCP-шного кластера на свою машину. Кстати, любая команда будет выполняться в фоне, если в конце добавить &. Я, если честно, не понял, зачем вы отправили нас читать информацию об этом на какой-то посторонний сайт))

![alt text](https://github.com/kot-mechanic/mongodb_otus/blob/main/screen/2022-02-08%2021_07_52-Window.png)

Зашел в монго без авторизации и попробовал посмотреть статус репликасета - статут посмотреть не удалось, т.к. не авторизован.
![alt text](https://github.com/kot-mechanic/mongodb_otus/blob/main/screen/2022-02-08%2021_08_28-Window.png)

Выполнил команду, которая выдергивает пароль монги и кладет ее в переменную.
```{r eval=FALSE}
# export MONGODB_ROOT_PASSWORD=$(kubectl get secret --namespace default mongo-mongodb -o jsonpath="{.data.mongodb-root-password}"
```

Затем вошел в монго с авторизацией. Посмотреть статус удалось.

![alt text](https://github.com/kot-mechanic/mongodb_otus/blob/main/screen/2022-02-08%2021_59_51-Window.png)
